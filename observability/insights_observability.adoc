[#integrate-rh-insights]
= Integrate observability with Red Hat insights

You can integrate {product-title} observability with Red Hat Insights to help identify existing or potential problems in your clusters. Red Hat Insights helps you to identify, prioritize, and resolve stability, performance, network, and security risks. {ocp} offers local health monitoring through OpenShift Cluster Manager. OpenShift Cluster Manager collects anonymized, aggregrated information about the health, usage, and size of the clusters. For more information, see https://access.redhat.com/documentation/en-us/red_hat_insights/2021/[Red Hat Insights product documentation].

*Required access*: Cluster administrator

[#prerequisites-obs-insights]
== Prerequisites

* Install Red Hat Insights
* Access to OpenShift Cluster Manager to view Red Hat Insights
* You must have the Customer Experience (CCX) server connected to your cluster. Set up the proxy for outbound ports to `https://cloud.redhat.com/api/insights`, to communicate with Red Hat Insights. See xref:../observability/setup_proxy.adoc#set-up-proxy-observability[Setting up a proxy for observability].
//^dev issue 11807

[#integrating-insights]
== Integrating Red Hat Insights

Red Hat Insights is included in the {product-title-short} installation. When you create or import a cluster, data from your managed cluster is automatically retrieved by Red Hat Insights.

From the potential issue side panel, you can use the search feature to search for specific remediation options. 

You can view the remediation options that are displayed from Insights. The remediation option displays the _Description_ of the vulnerability, _Category_ that vulnerability is associated with, and the _Total risk_. You can add multiple labels to the _Category_ section.

The _Status_ card displays information about _Nodes_, _Applications_, _Policy violations_, and _Identified issues_. The _Nodes_ status informs you of the number of nodes that are inactive. The _Applications_ status directs you to the _Overview_ tab of the _Applications_ page. The _Policy violations_ status directs you to the _Governance_ page. The _Identified issues_ status displays the number of issues per severity. The risks used to triage the issues are the following severity levels: _Critical_, _Major_, _Low_, and _Warning_.

From the _Description_ section, you can select the link to the vulnerability. You can view steps to resolve your vulnerabilty by viewing the _How to remediate_ tab. You can also view why the vulnerability occurred by clicking the _Reason_ tab. 


Each vulnerability report has its own CR that is created on the hub cluster.

//notes from the playback; the CCX server is 
//. If search is disabled, you can navigate to the OCP console 
//. From the OCP console, select *Pods*
//. Search for the insights client by entering _insights_ in the search bar.
//. To view the logs, select a specific pod and click the _Logs_ tab.
//. 

[#integrating-insights]
== Integrating Red Hat Insights

[#search-insight-policy-report-violation]
== Searching for insight policy reports

You can search for a specific insight policy reports that have violation, across your managed clusters. Complete the following steps to search for insight policy reports:

. Log in to your {product-title-short} hub cluster.
. Click the _Search_ icon in the console header to navigate to the _Search_ page.
. From the _Search_ page, enter the following query: `kind:policyreport`
. After you press enter, a table list of insight policy reports appear in the _Policyreport_ section.
+
*Note*: The `policyreport` name matches the name of the cluster. 
. You can also further specify your query by the insight policy violation and categories.
. When you select an insight policy report to view, the YAML is displayed.

[#viewing-vulnerabilities-insights]
== Viewing potential vulnerabilities from the console

//viewing vulnerabilities or viewing insights? 
You can view the vulnerabilities on a specific cluster by completing the following steps:

. Log in to your {product-title-short} cluster.
. From the navigation menu, select *Overview*. You can view details of the cluster issues and the severities from the _Cluster issues_ summary card.
. Select a severity to view the `PolicyReports` that are associated with the severity. You are directed to the _Search_ page, where the `PolicyReport` details are displayed.
. Select the `PolicyReport` name to be directed to the insight from the _Clusters_ page.
. Alternatively, you can select *Clusters* from the navigation menu.
. Select a managed cluster from the table to view more details.
. From the _Status_ card, view the number of potential issues.
. Select the number of potential issue to view the severity diagram and remediation options for the issues.
. Click the link to the vulnerability to view steps on _How to remediate_ and the _Reason_ for the vulnerability.
. If there are more vulnerabilities, click *Back* to view the list of potential issues.

[#viewing-etcd-grafana]
=== Viewing etcd chart

You can view the etcd dashboard in Grafana by completing the following steps:

. Log in to your {product-title-short} hub cluster.
. From the navigation menu, select *Overview*. Click the *Grafana* link.
. View the _etcd_ table from the hub cluster dashboard to see the _Leader election changes_ across managed clusters.
. Select a specific cluster to view more details.
